# MetaMask 컨펌 없이 자동 실행하기

## 현재 상황

### ✅ MetaMask 컨펌이 **필요 없는** 트랜잭션 (서버에서 자동 실행)
- `updatePositions()` - 서버가 자동 호출
- `settleRound()` - 서버가 자동 호출  
- `startNewRound()` - 서버가 자동 호출

이 트랜잭션들은 **게임 서버**가 개인키로 직접 서명하여 전송하므로 MetaMask 컨펌이 필요 없습니다.

### ⚠️ MetaMask 컨펌이 **필요한** 트랜잭션 (사용자 트랜잭션)
- `placeBet()` - 베팅할 때 (사용자가 직접 베팅)
- `claimWinnings()` - 수익금 받을 때 (사용자가 직접 클레임)

이 트랜잭션들은 **사용자의 지갑**에서 서명해야 하므로 MetaMask 컨펌이 필요합니다.

## 서버가 제대로 작동하는지 확인

게임 서버가 실행 중이면 다음 로그가 표시됩니다:

```
🚀 Oracle Derby 게임 서버 시작
📍 컨트랙트 주소: 0x...
👤 서버 지갑 주소: 0x...
💰 서버 지갑 잔액: X MONAD
👂 이벤트 리스너 설정 중...
✅ 이벤트 리스너 설정 완료
⏰ 자동 실행 시작 (5초마다 체크)
```

Racing Phase가 되면:
```
[시간] 🏃 updatePositions 호출 (elapsed: Xs)
  ✅ 트랜잭션 전송: 0x...
```

이런 메시지가 보이면 서버가 정상 작동 중입니다.

## 문제 해결

### 서버가 작동하지 않는 경우

1. **서버가 실행 중인지 확인**
   ```bash
   cd game-server
   npm start
   ```

2. **.env 파일 확인**
   - `SERVER_PRIVATE_KEY`가 올바르게 설정되었는지 확인
   - 서버 지갑에 가스비가 충분한지 확인

3. **서버 로그 확인**
   - 오류 메시지가 있는지 확인
   - 트랜잭션이 전송되는지 확인

### 베팅/클레임 시 컨펌이 필요한 이유

베팅과 클레임은 **사용자의 지갑**에서 실행되는 트랜잭션이므로:
- 사용자의 자금이 이동 (베팅: 지출, 클레임: 수령)
- 사용자가 직접 승인해야 함
- 보안상 필수적

이것은 정상적인 동작이며, 변경할 수 없습니다.

## 요약

- **서버 트랜잭션 (updatePositions 등)**: MetaMask 컨펌 불필요 ✅
- **사용자 트랜잭션 (베팅, 클레임)**: MetaMask 컨펌 필요 ⚠️

서버가 정상 작동하면 게임 상태 업데이트는 자동으로 이루어지며, 사용자는 베팅과 클레임만 직접 하면 됩니다.

